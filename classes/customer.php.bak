<?php

/**
*  customer.php 
* 
*  customer class definition
* 
*  @author	Daniel VC
* 
*/

class customer {

    require('../lib/conexionbd.lib.php');

    # get data from html form
    function get_from_form() {
    
        $this->empresa = $_POST['empresa'];
        $this->nit = $_POST['nit'];
        $this->solicitante = $_POST['solicitante'];
        $this->cargo = $_POST['cargo'];
        $this->direccion = $_POST['direccion'];
        $this->telefono = $_POST['telefono'];
        $this->fax = $_POST['fax'];
        $this->ciudad = $_POST['ciudad'];
        $this->email = $_POST['email'];
        $this->contrato = $_POST['contrato'];
        $this->feccontrato = $_POST['feccontrato'];
        $this->cotizacion = $_POST['cotizacion'];
        $this->feccotizacion = $_POST['feccotizacion'];
    
    } # end get_from_form function
    
    # check if nit exists in database
    function check_nit($pnit) {    
    
        # $sql = sprintf("SELECT * FROM lms_clientes WHERE nit = '%s'",mysql_real_escape_string($pnit));
        $sql = sprintf("SELECT * FROM lms_clientes WHERE nit = '%s'",$this->quote_smart($pnit));
        
        echo "SQL: ".$sql;
        
        /*
        $rst = mysql_query($sql);
        $nr = mysql_num_rows($rst);
        if ($nr > 0) {            
            while ($row = mysql_fetch_assoc($rst)) {
                $this->company = $row['empresa'];
                $this->nit = $row['nit'];
            }                       
            //$answer = 'false';
        } else {            
            //$answer = 'true';
        }
        
        //return $answer;
        //echo "Resultado: ".$answer;
        */        
            
    } # end check_nit function

    // save_customer function
    function save_customer() {
        
        if(!empty($this->empresa) && !empty($this->nit)) {
            if( $this->check_nit($this->nit) == true) {
                echo "<p class='logout'>OK! customer will be stored on database.";
            }                
        } else {
            echo "<p class='redalert'>Error! NIT and Company's Name are mandatory.";
        }
        
    } # end save_customer function
    
    mysql_close($conn);
    
} # end customer class definition

// create customer object
$ocustomer = new customer();

?>
